Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null===this)throw new TypeError;var e=Object(this),r=e.length>>>0;if(0===r)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&1/0!==n&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var i=n>=0?n:Math.max(r-Math.abs(n),0);r>i;i++)if(i in e&&e[i]===t)return i;return-1}),function(t){"use strict";var e=function(t,r,n){var i,o,a,s=/^([a-zA-Z]+)(\.[a-zA-Z]*)*$/;if(null===t.match(s)||"window"===t)throw Error("namespace: "+t+" is a malformed namespace string");if(void 0!==r&&void 0===n)if("function"==typeof r)n=r,r=void 0;else{if("object"==typeof r)throw Error("namespace: if second argument exists, final function argument must exist");if("object"!=typeof r)throw Error("namespace: second argument must be an object of aliased local namespaces")}else if("object"!=typeof r&&"function"==typeof n)throw Error("namespace: second argument must be an object of aliased local namespaces");if(i=t.split("."),o="window"===i[0]?window:void 0===window[i[0]]?window[i[0]]={}:window[i[0]],void 0!==n&&"function"!=typeof n)throw Error("namespace: last parameter must be a function that accepts a namespace parameter");for(a=1;i.length>a;a+=1)void 0===o[i[a]]&&(o[i[a]]={}),o=o[i[a]];if(void 0===r&&n)n(o);else if(n){for(a in r)r.hasOwnProperty(a)&&(r[a]=e(r[a]));n.call(r,o)}return o};return e(t,function(t){t.namespace=e})}("window.jermaine.util"),window.jermaine.util.namespace("window.jermaine.util",function(t){"use strict";var e=function(){var t=this,e={};return this.on=function(r,n){if("string"!=typeof r)throw Error("EventEmitter: first argument to 'on' should be a string");if("function"!=typeof n)throw Error("EventEmitter: second argument to 'on' should be a function");return e[r]||(e[r]=[]),e[r].push(n),t},this.addListener=this.on,this.once=function(e,r){var n=function(){r(arguments),t.removeListener(e,n)};return t.on(e,n),t},this.removeListener=function(r,n){var i;if("string"!=typeof r)throw Error("EventEmitter: first parameter to removeListener method must be a string representing an event");if("function"!=typeof n)throw Error("EventEmitter: second parameter must be a function to remove as an event listener");if(void 0===e[r]||0===e[r].length)throw Error("EventEmitter: there are no listeners registered for the '"+r+"' event");return i=e[r].indexOf(n),-1!==i&&e[r].splice(i,1),t},this.removeAllListeners=function(r){if("string"!=typeof r)throw Error("EventEmitter: parameter to removeAllListeners should be a string representing an event");return void 0!==e[r]&&(e[r]=[]),t},this.setMaxListeners=function(){return t},this.listeners=function(t){if("string"!=typeof t)throw Error("EventEmitter: listeners method must be called with the name of an event");return void 0===e[t]?[]:e[t]},this.emit=function(t){var r,n;for(arguments.length>1&&(n=[]),r=1;arguments.length>r;++r)n.push(arguments[r]);if(void 0!==e[t])for(r=0;e[t].length>r;r+=1)e[t][r].apply(this,n)},t};t.EventEmitter=e}),window.jermaine.util.namespace("window.jermaine",function(t){"use strict";var e,r={};e=function(t){var e=function(e){var r,n,i={};if(r=t.call(i,e),!r)throw n=i.message||"validator failed with parameter "+e,Error(n);return r};return e},e.addValidator=function(t,n,i){if(void 0===t||"string"!=typeof t)throw Error("addValidator requires a name to be specified as the first parameter");if(void 0===n||"function"!=typeof n)throw Error("addValidator requires a function as the second parameter");if(void 0!==i&&"function"!=typeof i)throw Error("addValidator third optional argument must be a function");if(void 0!==r[t])throw Error("Validator '"+t+"' already defined");r[t]=function(r){if(void 0!==i&&!i(r))throw Error("Validator: Invalid argument for "+t+" validator");return new e(function(t){var e={actual:t,param:t},i=n.call(e,r);return this.message=e.message,i})}},e.getValidator=function(t){var e;if(void 0===t)throw Error("Validator: getValidator method requires a string parameter");if("string"!=typeof t)throw Error("Validator: parameter to getValidator method must be a string");if(e=r[t],void 0===e)throw Error("Validator: '"+t+"' does not exist");return e},e.validators=function(){var t,e=[];for(t in r)r.hasOwnProperty(t)&&e.push(t);return e},e.addValidator("isGreaterThan",function(t){return this.message=this.param+" should be greater than "+t,this.param>t}),e.addValidator("isLessThan",function(t){return this.message=this.param+" should be less than "+t,t>this.param}),e.addValidator("isOneOf",function(t){return this.message=this.param+" should be one of the set: "+t,t.indexOf(this.param)>-1}),e.addValidator("isA",function(t){var e=["string","number","boolean","function","object"],r=window.jermaine.getModels();return"string"==typeof t&&e.indexOf(t)>-1?(this.message=this.param+" should be a "+t,typeof this.param===t):"string"==typeof t&&r.indexOf(t)>-1?(this.message="parameter should be an instance of "+t,this.param instanceof window.jermaine.getModel(t)):"integer"===t?(this.message=void 0!==this.param.toString?""+this.param+" should be an integer":"parameter should be an integer","number"==typeof this.param&&parseInt(this.param,10)===this.param):void 0},function(t){var e=["string","number","boolean","function","object","integer"].concat(window.jermaine.getModels());return e.indexOf(t)>=0}),r.isAn=r.isA,t.Validator=e}),window.jermaine.util.namespace("window.jermaine",function(t){"use strict";var e=function(t){var r,n,i,o,a=[],s=this,u="invalid setter call for "+t,h=!1,f={},d=window.jermaine.AttrList,l=window.jermaine.Validator;if(void 0===t||"string"!=typeof t)throw Error("Attr: constructor requires a name parameter which must be a string");for(o=function(t){for(n=0;a.length>n;++n)a[n](t);return!0},this.validatesWith=function(t){if("function"==typeof t)return a.push(new l(t)),this;throw Error("Attr: validator must be a function")},this.defaultsTo=function(t){return r=t,this},this.isReadOnly=function(){return h=!0,this},this.isWritable=function(){return h=!1,this},this.on=function(t,e){if("set"!==t&&"get"!==t)throw Error("Attr: first argument to the 'on' method should be 'set' or 'get'");if("function"!=typeof e)throw Error("Attr: second argument to the 'on' method should be a function");f[t]=e},this.name=function(){return t},this.validator=function(){return o},this.and=this,this.which=this,this.isImmutable=this.isReadOnly,this.isMutable=this.isWritable,this.clone=function(){var n,i;for(n=this instanceof d?new d(t):new e(t),i=0;a.length>i;++i)n.validatesWith(a[i]);return n.defaultsTo(r),h&&n.isImmutable(),n},this.addTo=function(e){var n,i;if(!e||"object"!=typeof e)throw Error("Attr: addAttr method requires an object parameter");if(e[t]=function(r){var i;if(void 0!==r){if(h&&void 0!==n)throw Error("cannot set the immutable property "+t+" after it has been set");if(!o(r))throw Error(u);return i=n,n=r,void 0!==f.set&&f.set.call(e,r,i),e}return void 0!==f.get&&f.get.call(e,n),n},i="function"==typeof r?r():r,void 0!==i&&o(i))e[t](i);else if(void 0!==i&&!o(i))throw Error("Attr: Default value of "+i+" does not pass validation for "+t)},i=function(t){s[t]=function(e){return a.push(l.getValidator(t)(e)),s}},n=0;l.validators().length>n;++n)i(l.validators()[n])};t.Attr=e}),window.jermaine.util.namespace("window.jermaine",function(t){"use strict";function e(e){var r=this,n={};t.Attr.call(this,e);var i=function(t,e){return function(){return t[e].apply(t,arguments)}};this.validateWith=this.validatesWith,this.defaultsTo=function(){},this.isImmutable=function(){},this.isMutable=function(){},this.eachOfWhich=this,this.on=function(t,e){if("add"!==t)throw Error("AttrList: 'on' only responds to 'add' event");if("function"!=typeof e)throw Error("AttrList: 'on' requires a listener function as the second parameter");n[t]=e},this.addTo=function(t){var o=[],a={};if(!t||"object"!=typeof t)throw Error("AttrList: addTo method requires an object parameter");a.pop=i(o,"pop"),a.add=function(e){if(r.validator()(e))return o.push(e),void 0!==n.add&&n.add.call(t,e,a.size()),this;throw Error(r.errorMessage())},a.replace=function(t,e){if("number"!=typeof t||parseInt(t,10)!==t)throw Error("AttrList: replace method requires index parameter to be an integer");if(0>t||t>=this.size())throw Error("AttrList: replace method index parameter out of bounds");if(!r.validator()(e))throw Error(r.errorMessage());return o[t]=e,this},a.at=function(t){if(0>t||t>=this.size())throw Error("AttrList: Index out of bounds");return o[t]},a.get=a.at,a.size=function(){return o.length},a.toJSON=function(t){var e,r=[];if(void 0!==t)for(e=0;t.length>e;++e)t[e].object===this&&(r=t[e].JSONrep);for(e=0;o.length>e;++e)o[e].toJSON?r.push(o[e].toJSON(t)):r.push(o[e]);return r},t[e]=function(){return a}}}e.prototype=new window.jermaine.Attr(name),t.AttrList=e}),window.jermaine.util.namespace("window.jermaine",function(t){"use strict";var e=function(t,e){if(!t||"string"!=typeof t)throw Error("Method: constructor requires a name parameter which must be a string");if(!e||"function"!=typeof e)throw Error("Method: second parameter must be a function");this.addTo=function(r){if(!r||"object"!=typeof r)throw Error("Method: addTo method requires an object parameter");r[t]=e}};t.Method=e}),window.jermaine.util.namespace("window.jermaine",function(t){"use strict";var e,r,n,i={};e=function(t){if("string"!=typeof t)throw Error("Jermaine: argument to getModel must be a string");if(void 0===i[t])throw Error("No model by the name of "+t+" found");return i[t]},r=function(){var t,e=[];for(t in i)e.push(t);return e},n=function(e){var r,o,a,s,u,h,f={},d={},l=!0,m=[],c=[],p=[],g=t.Method,v=t.Attr,w=t.AttrList,b=t.util.EventEmitter,E=function(){},y=function(){},j=function(){return l&&(j.validate(),u()),y.apply(this,arguments)};if(1===arguments.length&&"string"==typeof e&&(o=e,e=void 0),arguments.length>1&&(o=e,e=arguments[arguments.length-1]),e&&"function"==typeof e)return j=new n(o),e.call(j),j;if(e)throw Error("Model: specification parameter must be a function");if(void 0!==o&&"string"==typeof o)i[o]=j;else if(void 0!==o)throw Error("Model: model name must be a string");var A=function(t,e){var r,n,i;if(r="Attr"===t?v:w,n="Attr"===t?"hasA":"hasMany",l=!0,"string"==typeof e)return i=new r(e),d[e]=i,i;throw Error("Model: "+n+" parameter must be a string")};return a=function(t,e){var r;if("string"!=typeof e)throw Error("Model: expected string argument to "+t+" method, but recieved "+e);if(r="attribute"===t?d[e]:f[e],void 0===r)throw Error("Model: "+t+" "+e+" does not exist!");return r},s=function(t){var e,r=[],n="attributes"===t?d:f;for(e in n)n.hasOwnProperty(e)&&r.push(e);return r},u=function(){y=function(){var t,e,n,i,o,a,s=j.attributes(),u=j.methods(),f=new b,l={},p=this;if(!(this instanceof j))return arguments.length>0?new j(arguments):new j;for(this.emitter=function(){return f},this.emitter().removeJermaineChangeListener=function(t,e){if("string"!=typeof t)throw Error("attrName must be a string");if("object"!=typeof e||void 0===e.toJSON||void 0===e.emitter)throw Error("obj must be a jermaine object");e.emitter().removeListener("change",l[t])},this.emitter().addJermaineChangeListener=function(e,r){if("string"!=typeof e)throw Error("attrName must be a string");if("object"!=typeof r||void 0===r.toJSON||void 0===r.emitter)throw Error("obj must be a jermaine object");void 0===l[e]&&(l[e]=function(r){var n=[],i=!0;for(t=0;r.length>t&&i===!0;++t)n.push(r[t]),r[t].origin===p&&(i=!1);i&&(n.push({key:e,origin:p}),p.emit("change",n))}),r.emitter().on("change",l[e])},this.on=this.emitter().on,this.emit=this.emitter().emit,this.toJSON=function(t){var e,r,n,i,o={};if(void 0===t)t=[],t.push({object:this,JSONrep:o});else{if("object"!=typeof t)throw Error("Instance: toJSON should not take a parameter (unless called recursively)");for(r=0;t.length>r;++r)t[r].object===this&&(o=t[r].JSONrep)}for(r=0;s.length>r;++r){for(i=null,e=this[s[r]](),n=0;t.length>n;++n)t[n].object===e&&(i=t[n].JSONrep);void 0!==e&&null!==e&&void 0!==e.toJSON&&null===i&&(i=d[s[r]]instanceof w?[]:{},t.push({object:e,JSONrep:i}),t[t.length-1].JSONrep=e.toJSON(t)),o[s[r]]=null===i?e:i}return o},this.toString=void 0!==r?r:function(){return"Jermaine Model Instance"},a=function(t){t instanceof w?t.on("add",function(e){this.emit("change",[{action:"add",key:t.name(),value:e,origin:this}])}):t.on("set",function(e,r){if(void 0!==r&&null!==r&&void 0!==r.on&&void 0!==r.toJSON&&void 0!==r.emitter){if(1>r.emitter().listeners("change").length)throw Error("preValue should always have a listener defined if it is a model");this.emitter().removeJermaineChangeListener(t.name(),r)}void 0!==e&&null!==e&&void 0!==e.on&&void 0!==e.toJSON&&void 0!==e.emitter&&this.emitter().addJermaineChangeListener(t.name(),e),this.emit("change",[{key:t.name(),value:e,origin:this}])})},t=0;s.length>t;++t)o=j.attribute(s[t]),a.call(this,o);for(t=0;s.length+u.length>t;++t)s.length>t?(h&&j.attribute(s[t]).isImmutable(),j.attribute(s[t]).addTo(this)):j.method(u[t-s.length]).addTo(this);if(arguments.length>0){if(arguments.length<m.length){for(n="Constructor requires ",t=0;m.length>t;++t)n+=m[t],n+=t===m.length-1?"":", ";throw n+=" to be specified",Error(n)}if(arguments.length>m.length+c.length)throw Error("Too many arguments to constructor. Expected "+m.length+" required arguments and "+c.length+" optional arguments");for(t=0;arguments.length>t;++t)if(i=m.length>t?m[t]:c[t-m.length],j.attribute(i)instanceof w){if("[object Array]"!==Object.prototype.toString.call(arguments[t]))throw Error("Model: Constructor requires 'names' attribute to be set with an Array");for(e=0;arguments[t].length>e;++e)this[i]().add(arguments[t][e])}else this[i](arguments[t])}E.call(this)}},j.hasA=function(t){return A("Attr",t)},j.hasAn=j.hasA,j.hasSome=j.hasA,j.hasMany=function(t){return A("AttrList",t)},j.isA=function(t){var e,r,i,o;if(l=!0,o=function(t){var e,r=new n;for(e in r)if(r.hasOwnProperty(e)&&typeof t[e]!=typeof r[e])return!1;return!0},"function"!=typeof t||!o(t))throw Error("Model: parameter sent to isA function must be a Model");if(0!==p.length)throw Error("Model: Model only supports single inheritance at this time");for(p.push(t),r=p[0].attributes(),e=0;r.length>e;++e)void 0===d[r[e]]&&(d[r[e]]=p[0].attribute(r[e]).clone(),d[r[e]].isMutable());for(i=p[0].methods(),e=0;i.length>e;++e)void 0===f[i[e]]&&(f[i[e]]=p[0].method(i[e]));for(e=0;p.length>e;e++)j.prototype=new p[e]},j.isAn=j.isA,j.parent=function(){return p[0].apply(this,arguments)},j.attribute=function(t){return a("attribute",t)},j.attributes=function(){return s("attributes")},j.method=function(t){return a("method",t)},j.methods=function(){return s("methods")},j.isBuiltWith=function(){var t,e=!1;for(l=!0,m=[],c=[],t=0;arguments.length>t;++t)if("string"==typeof arguments[t]&&"%"!==arguments[t].charAt(0)){if(e)throw Error("Model: isBuiltWith requires parameters preceded with a % to be the final parameters before the optional function");m.push(arguments[t])}else if("string"==typeof arguments[t]&&"%"===arguments[t].charAt(0))e=!0,c.push(arguments[t].slice(1));else{if("function"!=typeof arguments[t]||t!==arguments.length-1)throw Error("Model: isBuiltWith parameters must be strings except for a function as the optional final parameter");E=arguments[t]}},j.isImmutable=function(){h=!0},j.looksLike=function(t){l=!0,r=t},j.respondsTo=function(t,e){var r=new g(t,e);l=!0,f[t]=r},j.validate=function(){var t,e=this.attributes(),r=this.methods();for(t=0;m.length>t;++t)try{this.attribute(m[t])}catch(n){throw Error(m[t]+", specified in the isBuiltWith method, is not an attribute")}for(t=0;c.length>t;++t)try{this.attribute(c[t])}catch(n){throw Error(c[t]+", specified in the isBuiltWith method, is not an attribute")}for(t=0;e.length>t;t++)if(r.indexOf(e[t])>-1)throw Error("Model: invalid model specification to "+e[t]+" being both an attribute and method");if(h)for(t=0;e.length>t;t++)if(0>m.indexOf(e[t]))throw Error("immutable objects must have all attributes required in a call to isBuiltWith");l=!1},j},t.getModel=e,t.getModels=r,t.Model=n});